<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Notes about what I discover while programming">

        <meta property="og:title" content="Build OpenCV for Java/Kotlin on macOS | David&#039;s Explorer Blog"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://hungry-lewin-fe0d4b.netlify.com/blog/java-build-opencv"/>
        <meta property="og:description" content="Notes about what I discover while programming" />

        <title>Build OpenCV for Java/Kotlin on macOS | David&#039;s Explorer Blog</title>

        <link rel="home" href="https://hungry-lewin-fe0d4b.netlify.com/">
        <link rel="icon" href="/favicon.ico">
        <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="David&#039;s Explorer Blog Atom Feed">

            <meta property="og:title" content="Build OpenCV for Java/Kotlin on macOS" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://hungry-lewin-fe0d4b.netlify.com/blog/java-build-opencv"/>
    <meta property="og:description" content="Building OpenCV for Java can be a bit of a trip." />

                    <!-- Matomo -->
                <script type="text/javascript">
                    var _paq = window._paq || [];
                    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
                    _paq.push(['trackPageView']);
                    _paq.push(['enableLinkTracking']);
                    (function() {
                        var u="https://matomo.dev.bushelops.com/";
                        _paq.push(['setTrackerUrl', u+'matomo.php']);
                        _paq.push(['setSiteId', '4']);
                        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
                        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
                    })();
                </script>
                <!-- End Matomo Code -->
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=595cdd7e11901d0dab8b">
    </head>

    <body class="flex flex-col justify-between min-h-screen bg-gray-100 text-gray-800 leading-normal font-sans">
        <header class="flex items-center shadow bg-white border-b h-24 py-4" role="banner">
            <div class="container flex items-center max-w-8xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/" title="David&#039;s Explorer Blog home" class="inline-flex items-center">
                        <img class="h-8 md:h-10 mr-3" src="/assets/img/logo.svg" alt="David&#039;s Explorer Blog logo" />

                        <h1 class="text-lg md:text-2xl text-blue-800 font-semibold hover:text-blue-600 my-0">David&#039;s Explorer Blog</h1>
                    </a>
                </div>

                <div id="vue-search" class="flex flex-1 justify-end items-center">
                    <search></search>

                    <nav class="hidden lg:flex items-center justify-end text-lg">
    <a title="David&#039;s Explorer Blog Blog" href="/blog"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        Blog
    </a>

    <a title="David&#039;s Explorer Blog About" href="/about"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        About
    </a>

    <a title="David&#039;s Explorer Blog Contact" href="/contact"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        Contact
    </a>
</nav>

                    <button class="flex justify-center items-center bg-blue-500 border border-blue-500 h-10 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

                </div>
            </div>
        </header>

        <nav id="js-nav-menu" class="nav-menu hidden lg:hidden">
    <ul class="my-0">
        <li class="pl-4">
            <a
                title="David&#039;s Explorer Blog Blog"
                href="/blog"
                class="nav-menu__item hover:text-blue-500 "
            >Blog</a>
        </li>
        <li class="pl-4">
            <a
                title="David&#039;s Explorer Blog About"
                href="/about"
                class="nav-menu__item hover:text-blue-500 "
            >About</a>
        </li>
        <li class="pl-4">
            <a
                title="David&#039;s Explorer Blog Contact"
                href="/contact"
                class="nav-menu__item hover:text-blue-500 "
            >Contact</a>
        </li>
    </ul>
</nav>

        <main role="main" class="flex-auto w-full container max-w-4xl mx-auto py-16 px-6">
                        <img src="/assets/img/3-ink-bottles.svg" alt="Build OpenCV for Java/Kotlin on macOS cover image" class="mb-2">
    
    <h1 class="leading-none mb-2">Build OpenCV for Java/Kotlin on macOS</h1>

    <p class="text-gray-700 text-xl md:mt-0">David Kanenwisher  â€¢  March 23, 2020</p>

                        <a
                href="/blog/categories/kotlin"
                title="View posts in kotlin"
                class="inline-block bg-gray-300 hover:bg-blue-200 leading-loose tracking-wide text-gray-800 uppercase text-xs font-semibold rounded mr-4 px-3 pt-px"
            >kotlin</a>
            
    <div class="border-b border-blue-200 mb-10 pb-4" v-pre>
        <p>The other day I went to bring OpenCV <a href="https://opencv.org/">OpenCV</a> into an <a href="https://openrndr.org/">OpenRNDR</a> project. I soon discovered there was more to it than I first thought.</p>

<p>Let's start with a few housekeeping things:</p>

<ol>
<li>Homebrew</li>
<li>Ant</li>
<li>SDKMAN</li>
</ol>

<p>If you don't have Homebrew, you'll either need to get it or find another way to install Ant.</p>

<p>You need to have Ant to build OpenCV. You can check if it's installed on the command line by checking it's version:</p>

<pre><code class="text">$ ant -v
Apache Ant(TM) version 1.10.7 compiled on September 1 2019
Trying the default build file: build.xml
Buildfile: build.xml does not exist!
Build failed
</code></pre>

<p>If you don't have Ant, I recommend installing it via homebrew like so:</p>

<pre><code class="text">$ brew install ant
</code></pre>

<p>Do you already have SDKMAN? It's not absolutely necessary but it makes it easy to switch between versions and to know they are configured in such a way OpenCV's build process can find it. You can find the install steps here: <a href="https://sdkman.io/install">https://sdkman.io/install</a>.</p>

<p>SDKMAN doesn't have the official JDK in it but you can add in any you have installed. You can either place them in the SDKMAN directory <code>/Users/davidkanenwisher/.sdkman/candidates/java</code> or link them. I have my JDK installed in <code>/Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/</code> so I linked it into SDKMAN like so:</p>

<pre><code class="text">ln -s /Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/ /Users/davidkanenwisher/.sdkman/candidates/java/1.8.0_241-oracle
</code></pre>

<p>Lastly, lets install and use your preferred java version. I'm going with Java 11 open JDK. With SDKMAN this is pretty easy. In your terminal run this command and answer yes to "set as default":</p>

<pre><code class="text">$ sdk install java 11.0.2-open
</code></pre>

<p>Feel free to use your preferred JDK though I don't know enough about OpenCV and Java to know if a certain JDK's won't work.</p>

<p>Let's get down to building OpenCV.</p>

<p>First, go to the OpenCV website and download the sources of the version you want to build: <a href="https://opencv.org/releases/">https://opencv.org/releases/</a>. I'm going with 4.2.0.</p>

<p>This unzips into the folder <code>opencv-4.2.0</code>. Don't switch into that directory yet! In the same directory as <code>opencv-4.2.0</code> create a folder <code>build_opencv-420</code> and switch into it <code>build_opencv-420</code>:</p>

<pre><code class="text">$ mkdir build_opencv-420
$ cd build_opencv-420
</code></pre>

<p>Before you can build OpenCV you need configure and create the cmake file:</p>

<pre><code class="text">$ cmake -DBUILD_SHARED_LIBS=OFF -DCMAKE_BUILD_TYPE=Release -DBUILD_EXAMPLES=ON -DBUILD_opencv_java=ON ../opencv-4.2.0 &amp;&gt; output.txt
</code></pre>

<p>Now take a peak at <code>output.txt</code> and check to see if Java support is going to be built. In there you should see:</p>

<pre><code class="text">--     To be built:                 calib3d core dnn features2d flann gapi highgui imgcodecs imgproc java ml objdetect photo python3 stitching ts video videoio
</code></pre>

<pre><code class="text">--   Java:
--     ant:                         /usr/local/bin/ant (ver 1.10.7)
--     JNI:                         /Users/davidkanenwisher/.sdkman/candidates/java/current/include /Users/davidkanenwisher/.sdkman/candidates/java/current/include/darwin /Users/davidkanenwisher/.sdkman/candidates/java/current/include
--     Java wrappers:               YES
--     Java tests:                  YES
</code></pre>

<p>Ok, now it's time to build OpenCV. Your poor computer is going to have to work pretty hard to make this happen so make sure you can live without it for an hour or so depending on your hardware. When you're ready run this command:</p>

<pre><code class="text">$ make -j8
</code></pre>

<p>If all goes well you should get the message:</p>

<pre><code class="text">BUILD SUCCESSFUL
</code></pre>

<p>Amongst a whole bunch of other files you should have:</p>

<pre><code class="text">bin/opencv-420.jar
lib/libopencv_java420.dylib
</code></pre>

<p>The first, <code>opencv-420.jar</code>, is the jar file you'll need to import into your project.</p>

<p>The second, <code>libopencv_java420.dylib</code>, is the natively compiled library that you'll need to point to when you run your application.</p>

<p>Now that you have OpenCV ready to run in your Java/Kotlin application what awesome uses are you going to put it to? Send me a message on the <a href="/contact">contact page</a>.</p>
    </div>

    <nav class="flex justify-between text-sm md:text-base">
        <div>
                            <a href="https://hungry-lewin-fe0d4b.netlify.com/blog/when-type-inference-doesn&#039;t-cut-it" title="Older Post: When Type Inference Doesn&#039;t Cut It">
                    &LeftArrow; When Type Inference Doesn&#039;t Cut It
                </a>
                    </div>

        <div>
                            <a href="https://hungry-lewin-fe0d4b.netlify.com/blog/kotlin-folder" title="Newer Post: Kotlin Folder Got To Have It">
                    Kotlin Folder Got To Have It &RightArrow;
                </a>
                    </div>
    </nav>
        </main>

        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-none">
                <li class="md:mr-2">
                    &copy; <a href="https://bushelpowered.com" title="Bushel website">Bushel</a> 2020.
                </li>

                <li>
                    Built with <a href="http://jigsaw.tighten.co" title="Jigsaw by Tighten">Jigsaw</a>
                    and <a href="https://tailwindcss.com" title="Tailwind CSS, a utility-first CSS framework">Tailwind CSS</a>.
                </li>
            </ul>
        </footer>

        <script src="/assets/build/js/main.js?id=3ee46297b0ef985b07a8"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
    </body>
</html>
