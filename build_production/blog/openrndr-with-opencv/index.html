<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Notes about what I discover while programming">

        <meta property="og:title" content="Use OpenCV with OpenRNDR | David&#039;s Explorer Blog"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://dkanen.com/blog/openrndr-with-opencv"/>
        <meta property="og:description" content="Notes about what I discover while programming" />

        <title>Use OpenCV with OpenRNDR | David&#039;s Explorer Blog</title>

        <link rel="home" href="https://dkanen.com/">
        <link rel="icon" href="/favicon.ico">
        <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="David&#039;s Explorer Blog Atom Feed">

            <meta property="og:title" content="Use OpenCV with OpenRNDR" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://dkanen.com/blog/openrndr-with-opencv"/>
    <meta property="og:description" content="Make OpenCV available with the OpenRNDR template" />

                    <!-- Matomo -->
                <script type="text/javascript">
                    var _paq = window._paq || [];
                    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
                    _paq.push(['trackPageView']);
                    _paq.push(['enableLinkTracking']);
                    (function() {
                        var u="https://matomo.dev.bushelops.com/";
                        _paq.push(['setTrackerUrl', u+'matomo.php']);
                        _paq.push(['setSiteId', '4']);
                        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
                        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
                    })();
                </script>
                <!-- End Matomo Code -->
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=5caa0c2f7bf9e21596b3">
    </head>

    <body class="flex flex-col justify-between min-h-screen bg-gray-100 text-gray-800 leading-normal font-sans">
        <header class="flex items-center shadow bg-white border-b h-24 py-4" role="banner">
            <div class="container flex items-center max-w-8xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/" title="David&#039;s Explorer Blog home" class="inline-flex items-center">
                        <img class="h-8 md:h-10 mr-3" src="/assets/img/logo.svg" alt="David&#039;s Explorer Blog logo" />

                        <h1 class="text-lg md:text-2xl text-blue-800 font-semibold hover:text-blue-600 my-0">David&#039;s Explorer Blog</h1>
                    </a>
                </div>

                <div id="vue-search" class="flex flex-1 justify-end items-center">
                    <search></search>

                    <nav class="hidden lg:flex items-center justify-end text-lg">
    <a title="David&#039;s Explorer Blog Blog" href="/blog"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        Blog
    </a>

    <a title="David&#039;s Explorer Blog About" href="/about"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        About
    </a>

    <a title="David&#039;s Explorer Blog Contact" href="/contact"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        Contact
    </a>
</nav>

                    <button class="flex justify-center items-center bg-blue-500 border border-blue-500 h-10 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

                </div>
            </div>
        </header>

        <nav id="js-nav-menu" class="nav-menu hidden lg:hidden">
    <ul class="my-0">
        <li class="pl-4">
            <a
                title="David&#039;s Explorer Blog Blog"
                href="/blog"
                class="nav-menu__item hover:text-blue-500 "
            >Blog</a>
        </li>
        <li class="pl-4">
            <a
                title="David&#039;s Explorer Blog About"
                href="/about"
                class="nav-menu__item hover:text-blue-500 "
            >About</a>
        </li>
        <li class="pl-4">
            <a
                title="David&#039;s Explorer Blog Contact"
                href="/contact"
                class="nav-menu__item hover:text-blue-500 "
            >Contact</a>
        </li>
    </ul>
</nav>

        <main role="main" class="flex-auto w-full container max-w-4xl mx-auto py-16 px-6">
                        <img src="/assets/img/3-ink-bottles.svg" alt="Use OpenCV with OpenRNDR cover image" class="mb-2">
    
    <h1 class="leading-none mb-2">Use OpenCV with OpenRNDR</h1>

    <p class="text-gray-700 text-xl md:mt-0">David Kanenwisher  â€¢  April 2, 2020</p>

                        <a
                href="/blog/categories/kotlin"
                title="View posts in kotlin"
                class="inline-block bg-gray-300 hover:bg-blue-200 leading-loose tracking-wide text-gray-800 uppercase text-xs font-semibold rounded mr-4 px-3 pt-px"
            >kotlin</a>
            
    <div class="border-b border-blue-200 mb-10 pb-4" v-pre>
        <p>If you're like me you probably got started with <a href="https://openrndr.org/">OpenRNDR</a> by using their <a href="https://github.com/openrndr/openrndr-template">template</a>. Then you start fiddling with it and hooked up a camera or a kinect. At which point you may have wondered how in the world you do something with the pictures or video you're getting.</p>

<p>A quick search and you found yourself reading about OpenCV and scratching your head. At which point you may have thought, "How in the heck do I add this to my project?"</p>

<p>You proceed to do some more searches. After a bit of that you're pretty sure OpenCV isn't meant for you.</p>

<p>Friend, let me tell you something, you too can use OpenCV in your OpenRNDR project!</p>

<p>First, you'll need to compile OpenCV. Sure, it sounds daunting. I think my article on <a href="blog/java-build-opencv">compiling OpenCV for Java</a> can help. Go take a look.</p>

<p>Whew, did you get through it? It's quite a trip but now you should have the essential components you need to add OpenCV to your OpenRNDR project:</p>

<ol>
<li>The OpenCV jar.</li>
<li>The compiled native libraries.</li>
</ol>

<p>Let's go ahead and add OpenCV to OpenRNDR. I'm going to assume you're using some flavor of <a href="https://www.jetbrains.com/idea/download/">Intellij IDEA</a>. If not, you may be able to adapt what I'm doing here to your IDE.</p>

<p>Let's start with the <code>build.gradle.kts</code>. We're going to need to do a couple things in this file:</p>

<ol>
<li>Add dependency on the OpenCV jar.</li>
<li>Update the version of Java to the one you built the OpenCV jar against.</li>
</ol>

<p>For the first step you'll need the path to the OpenCV jar you built. For me that's <code>/Users/davidkanenwisher/Projects/build_opencv-349/bin/opencv-349.jar</code>.</p>

<p>Now open <code>build.gradle.kts</code>. Find <code>dependencies</code> and inside the curly braces <code>{}</code> add the line <code>implementation(files("/Users/davidkanenwisher/Projects/build_opencv-349/bin/opencv-349.jar"))</code>. Make sure to replace my path with your path. You're <code>dependencies</code> section should look something like this:</p>

<pre><code class="language-text">dependencies {

    /*  This is where you add additional (third-party) dependencies */

//    implementation("org.jsoup:jsoup:1.12.2")
//    implementation("com.google.code.gson:gson:2.8.6")

    //&lt;editor-fold desc="Managed dependencies"&gt;
    runtimeOnly(openrndr("gl3"))
    runtimeOnly(openrndrNatives("gl3"))
    implementation(openrndr("openal"))
    runtimeOnly(openrndrNatives("openal"))
    implementation(openrndr("core"))
    implementation(openrndr("svg"))
    implementation(openrndr("animatable"))
    implementation(openrndr("extensions"))
    implementation(openrndr("filter"))

    implementation("org.jetbrains.kotlinx", "kotlinx-coroutines-core","1.3.3")
    implementation("io.github.microutils", "kotlin-logging","1.7.8")

    when(applicationLogging) {
        Logging.NONE -&gt; {
            runtimeOnly("org.slf4j","slf4j-nop","1.7.29")
        }
        Logging.SIMPLE -&gt; {
            runtimeOnly("org.slf4j","slf4j-simple","1.7.29")
        }
        Logging.FULL -&gt; {
            runtimeOnly("org.apache.logging.log4j", "log4j-slf4j-impl", "2.13.0")
            runtimeOnly("com.fasterxml.jackson.core", "jackson-databind", "2.10.1")
            runtimeOnly("com.fasterxml.jackson.dataformat", "jackson-dataformat-yaml", "2.10.1")
        }
    }

    if ("video" in openrndrFeatures) {
        implementation(openrndr("ffmpeg"))
        runtimeOnly(openrndrNatives("ffmpeg"))
    }

    if ("panel" in openrndrFeatures) {
        implementation("org.openrndr.panel:openrndr-panel:$panelVersion")
    }

    for (feature in orxFeatures) {
        implementation(orx(feature))
    }

    if ("orx-kinect-v1" in orxFeatures) {
        runtimeOnly(orxNatives("orx-kinect-v1"))
    }

    if ("orx-olive" in orxFeatures) {
        implementation("org.jetbrains.kotlin", "kotlin-scripting-compiler-embeddable")
    }

    implementation(kotlin("stdlib-jdk8"))
    testImplementation("junit", "junit", "4.12")
    //&lt;/editor-fold&gt;

    implementation(files("/Users/davidkanenwisher/Projects/build_opencv-349/bin/opencv-349.jar"))
}
</code></pre>

<p>Mostly just pay attention to the last line. It's the one we added. If other parts are different it may be different versions of the template.</p>

<p>The second step you only need to do if didn't build OpenCV against Java 8. I built mine against Java 11. This meant I had to update these lines in <code>build.gradle.kts</code> to reflect that:</p>

<pre><code class="language-text">configure&lt;JavaPluginConvention&gt; {
    sourceCompatibility = JavaVersion.VERSION_1_8
}
tasks.withType&lt;KotlinCompile&gt; {
    kotlinOptions.jvmTarget = "1.8"
}
</code></pre>

<p>I changed these from <code>JavaVersion.VERSION_1_8</code> to <code>JavaVersion.VERSION_11</code> and <code>1.8</code> to <code>11</code> like so:</p>

<pre><code class="language-text">configure&lt;JavaPluginConvention&gt; {
    sourceCompatibility = JavaVersion.VERSION_11
}
tasks.withType&lt;KotlinCompile&gt; {
    kotlinOptions.jvmTarget = "11"
}
</code></pre>

<p>The last step before we get to see if it works. There's likely a better way to do this but it's the best I've come up with so far. In Intellij go to <code>File &gt; Project Structure</code>. On there go to <code>Modules</code>. You'll see some folders with your project at the top if it's still named <code>openrndr-template</code> that's what you'll see otherwise it will be your project name. Click <code>main</code> below that.</p>

<p>At that point you should see in the list <code>opencv-349.jar</code>. Note the name may be different depending on the folder you built it in.  Double-click on that. Then a little window should pop up titled "Configure Module Library". Click the little bitty <code>+</code> button in the lower left corner.</p>

<p>A file navigator window should open. Navigate to the file where you compiled opencv and select <code>lib</code>. For me that is <code>/Users/davidkanenwisher/Projects/build_opencv-349/lib</code>. You should see "Native Library Locations" with the path to the directory you just added.</p>

<p>Now let's see if this puppy runs! Open <code>TemplateProgram.kt</code> and change it to:</p>

<pre><code class="language-kotlin">import org.opencv.core.Core
import org.opencv.core.CvType
import org.opencv.core.Mat
import org.opencv.core.Scalar
import org.openrndr.application

fun main() = application {

    System.loadLibrary(Core.NATIVE_LIBRARY_NAME)

    print("Welcome to OpenCV " + Core.VERSION)

    println("Welcome to OpenCV " + Core.VERSION)
    val m = Mat(5, 10, CvType.CV_8UC1, Scalar(0.0))
    println("OpenCV Mat: $m")
    val mr1: Mat = m.row(1)
    mr1.setTo(Scalar(1.0))
    val mc5: Mat = m.col(5)
    mc5.setTo(Scalar(5.0))
    println(
        """
            OpenCV Mat data:
            ${m.dump()}
            """.trimIndent()
    )
}
</code></pre>

<p>Then click the little green arrow next to <code>main()</code> and you should get this output:</p>

<pre><code class="language-text">Welcome to OpenCV 3.4.9Welcome to OpenCV 3.4.9
OpenCV Mat: Mat [ 5*10*CV_8UC1, isCont=true, isSubmat=false, nativeObj=0x7fa51864a6e0, dataAddr=0x7fa51864a740 ]
         OpenCV Mat data:
         [  0,   0,   0,   0,   0,   5,   0,   0,   0,   0;
1,   1,   1,   1,   1,   5,   1,   1,   1,   1;
0,   0,   0,   0,   0,   5,   0,   0,   0,   0;
0,   0,   0,   0,   0,   5,   0,   0,   0,   0;
0,   0,   0,   0,   0,   5,   0,   0,   0,   0]
</code></pre>

<p>I hope it all went well. You should be able to add face detection, edge detection, or whatever other neat OpenCV features you'd like to add to your project now! Let me know what you get up to with OpenRNDR and OpenCV by dropping me a line on the <a href="/contact">contact page</a>.</p>
    </div>

    <nav class="flex justify-between text-sm md:text-base">
        <div>
                            <a href="https://dkanen.com/blog/kotlin-folder" title="Older Post: Kotlin Folder Got To Have It">
                    &LeftArrow; Kotlin Folder Got To Have It
                </a>
                    </div>

        <div>
                            <a href="https://dkanen.com/blog/no-observable-object" title="Newer Post: No Observable Object">
                    No Observable Object &RightArrow;
                </a>
                    </div>
    </nav>
        </main>

        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-none">
                <li class="md:mr-2">
                    &copy; David Kanenwisher 2022.
                </li>

                <li>
                    Built with <a href="http://jigsaw.tighten.co" title="Jigsaw by Tighten">Jigsaw</a>
                    and <a href="https://tailwindcss.com" title="Tailwind CSS, a utility-first CSS framework">Tailwind CSS</a>.
                </li>
            </ul>
        </footer>

        <script src="/assets/build/js/main.js?id=e9d303e5fa2156a5d2f9"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
    </body>
</html>
