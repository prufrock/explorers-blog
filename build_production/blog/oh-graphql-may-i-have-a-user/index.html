<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="A great blog you&#039;ll love to read!">

        <meta property="og:title" content="Oh GraphQL, May I Have Some Users? | David&#039;s Engineering Blog"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://dkanen.scaleticket.net/blog/oh-graphql-may-i-have-a-user"/>
        <meta property="og:description" content="A great blog you&#039;ll love to read!" />

        <title>Oh GraphQL, May I Have Some Users? | David&#039;s Engineering Blog</title>

        <link rel="home" href="https://dkanen.scaleticket.net">
        <link rel="icon" href="">
        <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="David&#039;s Engineering Blog Atom Feed">

            <meta property="og:title" content="Oh GraphQL, May I Have Some Users?" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://dkanen.scaleticket.net/blog/oh-graphql-may-i-have-a-user"/>
    <meta property="og:description" content="Where in I struggle and then succeed to get some users from the users query in GraphQL." />

                    <!-- Matomo -->
                <script type="text/javascript">
                    var _paq = window._paq || [];
                    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
                    _paq.push(['trackPageView']);
                    _paq.push(['enableLinkTracking']);
                    (function() {
                        var u="https://matomo.dev.bushelops.com/";
                        _paq.push(['setTrackerUrl', u+'matomo.php']);
                        _paq.push(['setSiteId', '4']);
                        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
                        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
                    })();
                </script>
                <!-- End Matomo Code -->
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=595cdd7e11901d0dab8b">
    </head>

    <body class="flex flex-col justify-between min-h-screen bg-gray-100 text-gray-800 leading-normal font-sans">
        <header class="flex items-center shadow bg-white border-b h-24 py-4" role="banner">
            <div class="container flex items-center max-w-8xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/" title="David&#039;s Engineering Blog home" class="inline-flex items-center">
                        <img class="h-8 md:h-10 mr-3" src="https://mk0bushelmtprod77fna.kinstacdn.com/wp-content/uploads/2019/06/logo-616x117.png" alt="David&#039;s Engineering Blog logo" />

                        <h1 class="text-lg md:text-2xl text-blue-800 font-semibold hover:text-blue-600 my-0">David&#039;s Engineering Blog</h1>
                    </a>
                </div>

                <div id="vue-search" class="flex flex-1 justify-end items-center">
                    <search></search>

                    <nav class="hidden lg:flex items-center justify-end text-lg">
    <a title="David&#039;s Engineering Blog Blog" href="/blog"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        Blog
    </a>

    <a title="David&#039;s Engineering Blog About" href="/about"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        About
    </a>

    <a title="David&#039;s Engineering Blog Contact" href="/contact"
        class="ml-6 text-gray-700 hover:text-blue-600 ">
        Contact
    </a>
</nav>

                    <button class="flex justify-center items-center bg-blue-500 border border-blue-500 h-10 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

                </div>
            </div>
        </header>

        <nav id="js-nav-menu" class="nav-menu hidden lg:hidden">
    <ul class="my-0">
        <li class="pl-4">
            <a
                title="David&#039;s Engineering Blog Blog"
                href="/blog"
                class="nav-menu__item hover:text-blue-500 "
            >Blog</a>
        </li>
        <li class="pl-4">
            <a
                title="David&#039;s Engineering Blog About"
                href="/about"
                class="nav-menu__item hover:text-blue-500 "
            >About</a>
        </li>
        <li class="pl-4">
            <a
                title="David&#039;s Engineering Blog Contact"
                href="/contact"
                class="nav-menu__item hover:text-blue-500 "
            >Contact</a>
        </li>
    </ul>
</nav>

        <main role="main" class="flex-auto w-full container max-w-4xl mx-auto py-16 px-6">
                        <img src="/assets/img/post-cover-image-2.png" alt="Oh GraphQL, May I Have Some Users? cover image" class="mb-2">
    
    <h1 class="leading-none mb-2">Oh GraphQL, May I Have Some Users?</h1>

    <p class="text-gray-700 text-xl md:mt-0">David Kanenwisher  â€¢  February 16, 2020</p>

    
    <div class="border-b border-blue-200 mb-10 pb-4" v-pre>
        <p>I've heard GraphQL is easy to pick up. I've done a little reading on the official <a href="https://graphql.org/">GraphQL site</a> and watch some videos on YouTube. I figure I got what I need to get started. I just need a GraphQL server.</p>

<p>I went the through the <a href="https://lighthouse-php.com/tutorial/#installation">tutorial</a> on Lighthouse PHP's website. Well, not the whole thing(yet), just the installation part. I stopped there because I got back the user like in their example.</p>

<p>GraphQL Query for a user</p>

<pre><code class="graphql">{
  user(id: 1) {
    id
    name
    email
  }
}
</code></pre>

<p>With this result:</p>

<pre><code class="graphql">{
  "data": {
    "user": {
      "id": "1",
      "name": "Shea Spencer DDS",
      "email": "ismael.fisher@example.net"
    }
  }
}
</code></pre>

<p>Notice how the of <strong>shape</strong> of the query and the result are similar? Maybe you're wondering why I said <strong>shape</strong>? It seems to be the fancy way the GraphQL folks like to say that, ignoring the "data" key, the query and the result have the same keys in the same order. Therefore if I add or remove keys from the query I can change what comes back. For instance I can remove "email" from the query.</p>

<p>GraphQL query for user without "email":</p>

<pre><code class="graphql">{
  user(id: 1) {
    id
    name
  }
}
</code></pre>

<p>Result of the GraphQL query:</p>

<pre><code class="graphql">{
  "data": {
    "user": {
      "id": "1",
      "name": "Shea Spencer DDS"
    }
  }
}
</code></pre>

<p>See how email is gone? Pretty neat, eh? I didn't have to do anything special in my PHP code to make that happen. Lighthouse just handles it for me. Pretty damn spiffy if you ask me. Ok, ok, let's get to the part where I confuse myself and then eventually resolve that confusion in a shower of JSON.</p>

<p>I saw this query for "user(id: 1)". (Can I take you aside for a moment and explain something to you? So those parentheses after "user" that's called an argument. Supposedly any field in GraphQL can take an argument. No more fuddling with the URL non-sense. Rockin' right?). I thought, "If I can get one user I must be able to get 2 users, 3 users, all of the users?" Being the intrepid explorer that I am I tried this query:</p>

<p>First attempt to get users from GraphQL:</p>

<pre><code class="graphql">{
  # switched user to users
  # you can put comments in GraphQL queries
  # so rad
  users {
    id
    name
    email
  }
}
</code></pre>

<p>This is when I realize...The game is a foot!</p>

<pre><code class="graphql">{
  "errors": [
    {
      "message": "Cannot query field \"id\" on type \"UserPaginator\".",
      "extensions": {
        "category": "graphql"
      },
      "locations": [
        {
          "line": 3,
          "column": 5
        }
      ]
    },
    {
      "message": "Cannot query field \"name\" on type \"UserPaginator\".",
      "extensions": {
        "category": "graphql"
      },
      "locations": [
        {
          "line": 4,
          "column": 5
        }
      ]
    },
    {
      "message": "Cannot query field \"email\" on type \"UserPaginator\".",
      "extensions": {
        "category": "graphql"
      },
      "locations": [
        {
          "line": 5,
          "column": 5
        }
      ]
    }
  ]
}
</code></pre>

<p>"I don't want a UserPaginator!", I shake my fist at the screen, "What is this nonsense. I read something about a schema! Show me the schema you foul ruffian!"</p>

<p>The GraphQL Playground has a little schema drawer on the left side. It doesn't response to shouting but it does respond, like a friendly button, to clicks. I scroll around a bit and find what I'm looking for:</p>

<pre><code class="graphql">type UserPaginator {
  paginatorInfo: PaginatorInfo!
  data: [User!]!
}
</code></pre>

<p>Ah ha! There's the User I want. For some reason it's shouting "User!" at me but I'll worry about that later. For now I venture forward. Everybody is always talking about the shapes of queries so I take a run at shaping my query to get at the "User!" in "UserPaginator".</p>

<p>UserPaginator show me Users!</p>

<pre><code class="graphql">{
  users {
    UserPaginator {
      data {
        name
      }
    }
  }
}
</code></pre>

<p>I guess not:</p>

<pre><code class="graphql">{
  "errors": [
    {
      "message": "Cannot query field \"UserPaginator\" on type \"UserPaginator\".",
      "extensions": {
        "category": "graphql"
      },
      "locations": [
        {
          "line": 3,
          "column": 5
        }
      ]
    }
  ]
}
</code></pre>

<p>Drat! That wasn't it. Back to the schema because I clearly don't understand what I think I'm working with. I find a "users" query defined in the schema. I'm pretty sure I got a hold of something here.</p>

<pre><code class="graphql">type Query {
  users(
    first: Int = 10
    page: Int
  ): UserPaginator
  user(id: ID): User
}
</code></pre>

<p>Does that mean "users" returns a UserPaginator? If so then I think I should treat the "users" element as a "UserPaginator" and put fields I want in there.</p>

<p>Query for the fields I want on UserPaginator:</p>

<pre><code class="graphql">{
  users {
    # data is a field on UserPaginator
      data {
        id
        name
        email
      }
  }
}
</code></pre>

<p>The result. I hit pay dirt!</p>

<pre><code class="graphql">{
  "data": {
    "users": {
      "data": [
        {
          "id": "1",
          "name": "Shea Spencer DDS",
          "email": "ismael.fisher@example.net"
        },
        {
          "id": "2",
          "name": "Prof. Soledad Larson",
          "email": "mmorissette@example.net"
        },
        {
          "id": "3",
          "name": "Dr. Coleman Boehm",
          "email": "senger.kolby@example.net"
        },
        {
          "id": "4",
          "name": "Jazmyn Padberg",
          "email": "london72@example.net"
        },
        {
          "id": "5",
          "name": "Parker Stokes",
          "email": "valentina.gulgowski@example.org"
        },
        {
          "id": "6",
          "name": "Raven McDermott",
          "email": "fpouros@example.org"
        },
        {
          "id": "7",
          "name": "Alec Pouros",
          "email": "erdman.herminio@example.org"
        },
        {
          "id": "8",
          "name": "Fanny Harber",
          "email": "erich80@example.com"
        },
        {
          "id": "9",
          "name": "Emelia Rogahn",
          "email": "thurman65@example.org"
        },
        {
          "id": "10",
          "name": "Jayne Klocko",
          "email": "kaya.rutherford@example.net"
        }
      ]
    }
  }
}
</code></pre>

<p>That's how I figured out how to get fields on the users query. I can't say I fully understand why UserPaginator gets to override "users" in the query. Also, why is the element "data" rather than "users"? It seems like I'm losing some useful type information there.</p>

<p>My questions aside, how's your GraphQL journey going?</p>
    </div>

    <nav class="flex justify-between text-sm md:text-base">
        <div>
                            <a href="https://dkanen.scaleticket.net/blog/test-events-were-not-received" title="Older Post: I&#039;ll Receive You Some Test Events!">
                    &LeftArrow; I&#039;ll Receive You Some Test Events!
                </a>
                    </div>

        <div>
                            <a href="https://dkanen.scaleticket.net/blog/lambda-sans-return" title="Newer Post: Lambda Sans Return">
                    Lambda Sans Return &RightArrow;
                </a>
                    </div>
    </nav>
        </main>

        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-none">
                <li class="md:mr-2">
                    &copy; <a href="https://bushelpowered.com" title="Bushel website">Bushel</a> 2020.
                </li>

                <li>
                    Built with <a href="http://jigsaw.tighten.co" title="Jigsaw by Tighten">Jigsaw</a>
                    and <a href="https://tailwindcss.com" title="Tailwind CSS, a utility-first CSS framework">Tailwind CSS</a>.
                </li>
            </ul>
        </footer>

        <script src="/assets/build/js/main.js?id=3ee46297b0ef985b07a8"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
    </body>
</html>
